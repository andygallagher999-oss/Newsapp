<style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:-apple-system, BlinkMacSystemFont,'Segoe UI', Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:10px;padding-bottom:80px;}
    .container{max-width:1200px;margin:0 auto;}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:10px;}
    .header h1{color:white;font-size:clamp(1.8rem,5vw,2.5rem);text-shadow:0 2px 4px rgba(0,0,0,0.3);}
    .date-display{color:white;font-size:1rem;}
    .status-bar{background:rgba(46,204,113,0.15);color:#2ecc71;padding:10px;border-radius:8px;text-align:center;font-size:0.9rem;margin-bottom:15px;border:1px solid rgba(46,204,113,0.2);}
    .controls{display:flex;justify-content:space-between;margin-bottom:20px;}
    .controls .source-buttons,.controls .category-buttons{display:flex;gap:8px;flex-wrap:wrap;}
    .controls button{padding:8px 12px;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all 0.2s ease;}
    .controls button.active{background:#ff6b6b;color:white;}
    .controls button:not(.active){background:rgba(255,255,255,0.2);color:white;}
    .loading{text-align:center;color:white;font-size:1rem;margin:30px 0;padding:20px;}
    .spinner{display:inline-block;width:25px;height:25px;border:3px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:white;animation:spin 1s ease-in-out infinite;margin-right:10px;}
    @keyframes spin{to{transform:rotate(360deg);}}
    .news-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:20px;}
    .news-card{background:white;border-radius:15px;overflow:hidden;box-shadow:0 8px 25px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer;}
    .news-card:hover{transform:translateY(-3px);box-shadow:0 15px 35px rgba(0,0,0,0.15);}
    .news-image{width:100%;height:180px;object-fit:cover;background:linear-gradient(45deg,#f0f2f5,#e1e5e9);}
    .news-content{padding:18px;}
    .news-source{display:inline-block;background:linear-gradient(45deg,#667eea,#764ba2);color:white;padding:4px 10px;border-radius:15px;font-size:11px;font-weight:600;margin-bottom:10px;text-transform:uppercase;}
    .news-title{font-size:1.1rem;font-weight:700;color:#2c3e50;margin-bottom:10px;line-height:1.4;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;}
    .news-summary{color:#555;line-height:1.5;margin-bottom:12px;font-size:0.9rem;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;overflow:hidden;}
    .news-meta{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid #eee;font-size:0.85rem;color:#888;}
    .news-date{font-weight:500;}
    .read-more{color:#667eea;text-decoration:none;font-weight:600;transition:color 0.3s ease;font-size:0.85rem;}
    .error{background:rgba(255,107,107,0.15);color:#ff6b6b;padding:15px;border-radius:10px;text-align:center;margin:20px 0;border:1px solid rgba(255,107,107,0.2);}
    .refresh-btn{position:fixed;top:20px;right:20px;background:rgba(255,255,255,0.2);color:white;border:none;border-radius:50%;width:50px;height:50px;font-size:20px;cursor:pointer;backdrop-filter:blur(10px);transition:all 0.3s ease;z-index:100;}
    .refresh-btn:hover{background:rgba(255,255,255,0.3);transform:scale(1.1);}
    #loadMoreBtn{margin:20px auto;display:block;padding:10px 20px;background:#667eea;color:white;border:none;border-radius:10px;cursor:pointer;font-weight:600;transition:all 0.2s ease;}
    #loadMoreBtn:hover{background:#764ba2;}
    @media(max-width:992px){.news-grid{grid-template-columns:repeat(2,1fr);}}
    @media(max-width:600px){.news-grid{grid-template-columns:repeat(2,1fr);}}
</style>

<div class="container">
    <div class="header">
        <h1>üåç Andy's Global News</h1>
        <div class="date-display" id="currentDate"></div>
    </div>

    <div class="status-bar">
        ‚úÖ <strong>Ready to use!</strong> No API keys needed - powered by RSS feeds
    </div>

    <div class="controls">
        <div class="source-buttons" id="sourceButtons"></div>
        <div class="category-buttons" id="categoryButtons"></div>
    </div>

    <div id="loading" class="loading" style="display:none;">
        <div class="spinner"></div> Fetching news...
    </div>

    <div id="error" class="error" style="display:none;"></div>

    <div id="newsContainer" class="news-grid"></div>
    <button id="loadMoreBtn" style="display:none;" onclick="loadMore()">Load More</button>
</div>

<button class="refresh-btn" onclick="fetchNews()">üîÑ</button>

<script>
const RSS_SOURCES = {
    'mixed':null,
    'bbc':{world:'http://feeds.bbci.co.uk/news/world/rss.xml',business:'http://feeds.bbci.co.uk/news/business/rss.xml',technology:'http://feeds.bbci.co.uk/news/technology/rss.xml',science:'http://feeds.bbci.co.uk/news/science_and_environment/rss.xml',health:'http://feeds.bbci.co.uk/news/health/rss.xml',sports:'http://feeds.bbci.co.uk/sport/rss.xml'},
    'cnn':{world:'http://rss.cnn.com/rss/edition.rss',business:'http://rss.cnn.com/rss/money_latest.rss',technology:'http://rss.cnn.com/rss/edition_technology.rss',science:'http://rss.cnn.com/rss/edition_space.rss',health:'http://rss.cnn.com/rss/edition_health.rss',sports:'http://rss.cnn.com/rss/edition_sport.rss'},
    'reuters':{world:'https://feeds.reuters.com/reuters/topNews',business:'https://feeds.reuters.com/reuters/businessNews',technology:'https://feeds.reuters.com/reuters/technologyNews',science:'https://feeds.reuters.com/reuters/scienceNews',health:'https://feeds.reuters.com/reuters/healthNews',sports:'https://feeds.reuters.com/reuters/sportsNews'},
    'ap':{world:'https://feeds.apnews.com/rss/apf-topnews',business:'https://feeds.apnews.com/rss/apf-business',technology:'https://feeds.apnews.com/rss/apf-technology',science:'https://feeds.apnews.com/rss/apf-science',health:'https://feeds.apnews.com/rss/apf-health',sports:'https://feeds.apnews.com/rss/apf-sports'},
    'guardian':{world:'https://www.theguardian.com/world/rss',business:'https://www.theguardian.com/business/rss',technology:'https://www.theguardian.com/technology/rss',science:'https://www.theguardian.com/science/rss',health:'https://www.theguardian.com/society/health/rss',sports:'https://www.theguardian.com/sport/rss'},
    'nyt':{world:'https://rss.nytimes.com/services/xml/rss/nyt/World.xml',business:'https://rss.nytimes.com/services/xml/rss/nyt/Business.xml',technology:'https://rss.nytimes.com/services/xml/rss/nyt/Technology.xml',science:'https://rss.nytimes.com/services/xml/rss/nyt/Science.xml',health:'https://rss.nytimes.com/services/xml/rss/nyt/Health.xml',sports:'https://rss.nytimes.com/services/xml/rss/nyt/Sports.xml'},
    'techcrunch':{world:'https://feeds.feedburner.com/TechCrunch/',business:'https://feeds.feedburner.com/TechCrunch/',technology:'https://feeds.feedburner.com/TechCrunch/',science:'https://feeds.feedburner.com/TechCrunch/',health:'https://feeds.feedburner.com/TechCrunch/',sports:'https://feeds.feedburner.com/TechCrunch/'},
    'usatoday':{world:'https://www.usatoday.com/rss/news/',business:'https://www.usatoday.com/rss/money/',technology:'https://www.usatoday.com/rss/technology/',science:'https://www.usatoday.com/rss/science/',health:'https://www.usatoday.com/rss/health/',sports:'https://www.usatoday.com/rss/sports/'},
    'npr':{world:'https://feeds.npr.org/1004/rss.xml',business:'https://feeds.npr.org/1019/rss.xml',technology:'https://feeds.npr.org/1019/rss.xml',science:'https://feeds.npr.org/1007/rss.xml',health:'https://feeds.npr.org/1128/rss.xml',sports:'https://feeds.npr.org/1039/rss.xml'},
    'cbc':{world:'https://rss.cbc.ca/lineup/world.xml',business:'https://rss.cbc.ca/lineup/business.xml',technology:'https://rss.cbc.ca/lineup/technology.xml',science:'https://rss.cbc.ca/lineup/science.xml',health:'https://rss.cbc.ca/lineup/health.xml',sports:'https://rss.cbc.ca/lineup/sports.xml'}
};

const SOURCES_ORDER = ['mixed','bbc','cnn','reuters','ap','guardian','nyt','techcrunch','usatoday','npr','cbc'];
const CATEGORY_ORDER = ['world','business','technology','science','health','sports'];

let selectedSource='mixed';
let selectedCategory='world';
let allArticles=[];
let displayedCount=0;
const BATCH_SIZE=12;

function formatDate(dateString){
    const date=new Date(dateString);return date.toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'});
}
function generateSummary(desc, content){let text=desc||content||''; text=text.replace(/<[^>]*>/g,'').replace(/&[^;]+;/g,' '); if(text.length>200) return text.substring(0,200).trim()+'...'; return text;}
function getRandomImage(category){const images={world:['https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1586769852044-692d6df3490f?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1495020689067-958852a7765e?w=400&h=200&fit=crop'],business:['https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1590479773265-7464e5d48118?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=200&fit=crop'],technology:['https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1518709268805-4e9042af9f23?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=400&h=200&fit=crop'],science:['https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=200&fit=crop'],health:['https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=400&h=200&fit=crop'],sports:['https://images.unsplash.com/photo-1461896836934-ffe607ba8211?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400&h=200&fit=crop','https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=200&fit=crop']}; const arr=images[category]||images.world; return arr[Math.floor(Math.random()*arr.length)];}

function createNewsCard(article, sourceName){const summary=generateSummary(article.description,article.content);const imageUrl=getRandomImage(selectedCategory); return `<div class="news-card" onclick="window.open('${article.link}','_blank')"><img src="${imageUrl}" alt="News Image" class="news-image" onerror="this.src='${getRandomImage(selectedCategory)}'"><div class="news-content"><div class="news-source">${sourceName}</div><h3 class="news-title">${article.title}</h3><p class="news-summary">${summary}</p><div class="news-meta"><span class="news-date">${formatDate(article.pubDate)}</span><span class="read-more">Read More ‚Üí</span></div></div></div>`;}

function displayNews(){const container=document.getElementById('newsContainer');container.innerHTML='';container.innerHTML=allArticles.slice(0,displayedCount).map(a=>createNewsCard(a.item,a.source)).join('');document.getElementById('loadMoreBtn').style.display=(displayedCount<allArticles.length)?'block':'none';}

function showLoading(show){document.getElementById('loading').style.display=show?'block':'none';}
function showError(msg){const e=document.getElementById('error');e.textContent=msg;e.style.display='block';setTimeout(()=>{e.style.display='none';},5000);}

async function parseRSSFeed(url, sourceName){
    try{const proxyUrl=`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}&api_key=&count=50`;const res=await fetch(proxyUrl);const data=await res.json(); if(data.status!=='ok') throw new Error(data.message||'Unknown error'); return data.items.map(i=>({source:sourceName,item:{title:i.title,description:i.description,content:i.content,link:i.link,pubDate:i.pubDate,author:i.author}}));}catch(err){console.error(`RSS error ${sourceName}:`,err);return[];}
}

async function fetchNews(){
    showLoading(true);showError('');document.getElementById('newsContainer').innerHTML='';displayedCount=0;allArticles=[];
    try{
        if(selectedSource==='mixed'){
            const sources=['bbc','reuters','ap','guardian','nyt','techcrunch','usatoday','npr','cbc'];
            const results=await Promise.all(sources.map(s=>parseRSSFeed(RSS_SOURCES[s][selectedCategory],getSourceDisplayName(s))));
            allArticles=results.flat();
        }else{
            allArticles=await parseRSSFeed(RSS_SOURCES[selectedSource][selectedCategory],getSourceDisplayName(selectedSource));
        }
        allArticles.sort((a,b)=>new Date(b.item.pubDate)-new Date(a.item.pubDate));
        displayedCount=Math.min(BATCH_SIZE,allArticles.length);
        if(allArticles.length===0) throw new Error('No articles found');
        displayNews();
    }catch(e){console.error(e);showError('Failed to fetch news: '+e.message);}
    finally{showLoading(false);}
}

function loadMore(){displayedCount=Math.min(displayedCount+BATCH_SIZE,allArticles.length);displayNews();}

function getSourceDisplayName(s){const names={'bbc':'BBC News','cnn':'CNN','reuters':'Reuters','ap':'Associated Press','guardian':'The Guardian','nyt':'New York Times','techcrunch':'TechCrunch','usatoday':'USA Today','npr':'NPR','cbc':'CBC'};return names[s]||s.toUpperCase();}

function createButtons(){
    const sb=document.getElementById('sourceButtons');
    SOURCES_ORDER.forEach(s=>{
        const btn=document.createElement('button');btn.textContent=getSourceDisplayName(s);btn.onclick=()=>{selectedSource=s;updateActiveButtons();fetchNews();};btn.id='source-'+s; sb.appendChild(btn);
    });
    const cb=document.getElementById('categoryButtons');
    CATEGORY_ORDER.forEach(c=>{
        const btn=document.createElement('button');btn.textContent=c.charAt(0).toUpperCase()+c.slice(1);btn.onclick=()=>{selectedCategory=c;updateActiveButtons();fetchNews();};btn.id='category-'+c; cb.appendChild(btn);
    });
}

function updateActiveButtons(){
    SOURCES_ORDER.forEach(s=>document.getElementById('source-'+s).classList.toggle('active',s===selectedSource));
    CATEGORY_ORDER.forEach(c=>document.getElementById('category-'+c).classList.toggle('active',c===selectedCategory));
}

function updateDate(){const d=new Date();document.getElementById('currentDate').textContent=d.toLocaleDateString('en-US',{weekday:'long',month:'short',day:'numeric',year:'numeric'});}

createButtons();updateActiveButtons();updateDate();fetchNews();setInterval(updateDate,60000);
</script>
